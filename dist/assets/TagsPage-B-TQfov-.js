import{G as I,r as k,k as t,B as f}from"./index-isBeRo1b.js";import{u as w}from"./useClosable-Dwegbn33.js";import{u as x,s as l}from"./index-DOY2cXOq.js";import{j as M}from"./client-D49sAvGJ.js";import{t as u}from"./tags-CgsCyJyh.js";import{C as b}from"./CrudDrawer-CCohrQdE.js";import{P as R}from"./PageHeader-CzhsRgKs.js";import{d as P}from"./dayjs.min-D51Aj4CE.js";import{F as y}from"./index-CO1TAYVF.js";import{R as N,C as Y,S as A}from"./index-CUCRgLKV.js";import{F as K}from"./Table-CbaHfp0x.js";import{I as Q}from"./index-BiEyZbEs.js";import{C as v}from"./ColorPicker-B6dSZ5qn.js";import{T as z}from"./index-CDKBTdtS.js";import{P as D}from"./index-DeMcSX5K.js";import{R as B}from"./DeleteOutlined-BdlBkdV1.js";import"./InfoCircleFilled-Ko0Gchp7.js";import"./index-CK1P3WPV.js";import"./QuestionCircleOutlined-DwuYyw29.js";import"./DownOutlined-C7Jp90Yl.js";import"./index-Dh7qLhW3.js";import"./index-DF4za2Tw.js";import"./index-BaCf-Qju.js";const ce=()=>{const[n]=y.useForm(),g=I(),[C,d]=k.useState(!1),[m,c]=k.useState(null),{data:p,isLoading:F}=w({queryKey:["tags"],queryFn:()=>u.getAll()}),h=x({mutationFn:e=>u.create(e),onSuccess:()=>{l.success("Teg yaratildi!"),g.invalidateQueries({queryKey:["tags"]}),d(!1),n.resetFields()},onError:e=>{var a,r,o,i;console.error("Create Tag Error:",e);const s=((r=(a=e.response)==null?void 0:a.data)==null?void 0:r.error)||((i=(o=e.response)==null?void 0:o.data)==null?void 0:i.message)||e.message||"Noma'lum xatolik";l.error(s)}}),j=x({mutationFn:({id:e,values:s})=>u.update(e,s),onSuccess:()=>{l.success("Teg yangilandi!"),g.invalidateQueries({queryKey:["tags"]}),d(!1),c(null),n.resetFields()},onError:e=>{var a,r,o,i;console.error("Update Tag Error:",e);const s=((r=(a=e.response)==null?void 0:a.data)==null?void 0:r.error)||((i=(o=e.response)==null?void 0:o.data)==null?void 0:i.message)||e.message||"Noma'lum xatolik";l.error(s)}}),S=x({mutationFn:e=>u.delete(e),onSuccess:()=>{l.success("Teg o'chirildi!"),g.invalidateQueries({queryKey:["tags"]})},onError:e=>{var a,r,o,i;console.error("Delete Tag Error:",e);const s=((r=(a=e.response)==null?void 0:a.data)==null?void 0:r.error)||((i=(o=e.response)==null?void 0:o.data)==null?void 0:i.message)||e.message||"Noma'lum xatolik";l.error(s)}}),T=e=>{var r,o;const s=typeof e.color=="string"?e.color:((o=(r=e.color)==null?void 0:r.toHexString)==null?void 0:o.call(r))||"#1890ff",a={...e,color:s};m?j.mutate({id:m.id,values:a}):h.mutate(a)},q=e=>{c(e),n.setFieldsValue(e),d(!0)},E=[{title:"Rang",dataIndex:"color",key:"color",width:60,render:e=>t.jsx("div",{style:{width:24,height:24,borderRadius:6,backgroundColor:e||"#ccc"}})},{title:"Nomi",dataIndex:"name",key:"name",render:(e,s)=>t.jsx(z,{color:s.color,children:e})},{title:"Slug",dataIndex:"slug",key:"slug",render:e=>e||"-"},{title:"Sana",dataIndex:"createdAt",key:"createdAt",width:120,render:e=>P(e).format("DD.MM.YYYY")},{title:"Amallar",key:"actions",width:120,render:(e,s)=>t.jsxs(A,{children:[t.jsx(f,{size:"small",icon:t.jsx(M,{}),onClick:()=>q(s)}),t.jsx(D,{title:"O'chirishni tasdiqlaysizmi?",onConfirm:()=>S.mutate(s.id),children:t.jsx(f,{size:"small",danger:!0,icon:t.jsx(B,{})})})]})}];return t.jsxs("div",{className:"space-y-4",children:[t.jsx(R,{title:"Teglar",subtitle:"Blog va yangiliklar uchun teglarni boshqarish",extra:t.jsx(f,{type:"primary",icon:t.jsx(N,{}),onClick:()=>{c(null),n.resetFields(),d(!0)},children:"Yangi teg"})}),t.jsx(Y,{children:t.jsx(K,{columns:E,dataSource:(p==null?void 0:p.data)||[],rowKey:"id",loading:F,pagination:{pageSize:10}})}),t.jsxs(b,{open:C,onClose:()=>{d(!1),c(null),n.resetFields()},title:m?"Tegni yangilash":"Yangi teg",form:n,onSubmit:T,loading:h.isPending||j.isPending,isEdit:!!m,width:380,children:[t.jsx(y.Item,{name:"name",label:"Nomi",rules:[{required:!0}],children:t.jsx(Q,{placeholder:"Huquq"})}),t.jsx(y.Item,{name:"color",label:"Rang",children:t.jsx(v,{})})]})]})};export{ce as default};
