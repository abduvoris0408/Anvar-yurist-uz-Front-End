var ge=s=>{throw TypeError(s)};var q=(s,e,t)=>e.has(s)||ge("Cannot "+t);var i=(s,e,t)=>(q(s,e,"read from private field"),t?t.call(s):e.get(s)),g=(s,e,t)=>e.has(s)?ge("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),u=(s,e,t,r)=>(q(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t),p=(s,e,t)=>(q(s,e,"access private method"),t);import{b5 as xe,b6 as me,b7 as O,b8 as ee,b9 as H,ba as te,bb as se,bc as Re,bd as Qe,be as X,bf as Ue,bg as De,bh as ve,bi as Me,r as w,bj as we,G as Fe,a1 as Pe,H as _,p as je,aH as Le}from"./index-F3grSWdG.js";import{a as Ne}from"./client-CX91g6yc.js";var v,n,V,m,U,P,M,x,W,j,L,D,F,Q,N,o,A,ie,re,ne,ae,oe,ce,le,Te,Ie,ke=(Ie=class extends xe{constructor(e,t){super();g(this,o);g(this,v);g(this,n);g(this,V);g(this,m);g(this,U);g(this,P);g(this,M);g(this,x);g(this,W);g(this,j);g(this,L);g(this,D);g(this,F);g(this,Q);g(this,N,new Set);this.options=t,u(this,v,e),u(this,x,null),u(this,M,me()),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(i(this,n).addObserver(this),Ce(i(this,n),this.options)?p(this,o,A).call(this):this.updateResult(),p(this,o,ae).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return he(i(this,n),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return he(i(this,n),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,p(this,o,oe).call(this),p(this,o,ce).call(this),i(this,n).removeObserver(this)}setOptions(e){const t=this.options,r=i(this,n);if(this.options=i(this,v).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof O(this.options.enabled,i(this,n))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");p(this,o,le).call(this),i(this,n).setOptions(this.options),t._defaulted&&!ee(this.options,t)&&i(this,v).getQueryCache().notify({type:"observerOptionsUpdated",query:i(this,n),observer:this});const a=this.hasListeners();a&&ye(i(this,n),r,this.options,t)&&p(this,o,A).call(this),this.updateResult(),a&&(i(this,n)!==r||O(this.options.enabled,i(this,n))!==O(t.enabled,i(this,n))||H(this.options.staleTime,i(this,n))!==H(t.staleTime,i(this,n)))&&p(this,o,ie).call(this);const c=p(this,o,re).call(this);a&&(i(this,n)!==r||O(this.options.enabled,i(this,n))!==O(t.enabled,i(this,n))||c!==i(this,Q))&&p(this,o,ne).call(this,c)}getOptimisticResult(e){const t=i(this,v).getQueryCache().build(i(this,v),e),r=this.createResult(t,e);return Ae(this,r)&&(u(this,m,r),u(this,P,this.options),u(this,U,i(this,n).state)),r}getCurrentResult(){return i(this,m)}trackResult(e,t){return new Proxy(e,{get:(r,a)=>(this.trackProp(a),t==null||t(a),a==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&i(this,M).status==="pending"&&i(this,M).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,a))})}trackProp(e){i(this,N).add(e)}getCurrentQuery(){return i(this,n)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=i(this,v).defaultQueryOptions(e),r=i(this,v).getQueryCache().build(i(this,v),t);return r.fetch().then(()=>this.createResult(r,t))}fetch(e){return p(this,o,A).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),i(this,m)))}createResult(e,t){var pe;const r=i(this,n),a=this.options,c=i(this,m),l=i(this,U),b=i(this,P),d=e!==r?e.state:i(this,V),{state:R}=e;let f={...R},I=!1,h;if(t._optimisticResults){const y=this.hasListeners(),B=!y&&Ce(e,t),G=y&&ye(e,r,t,a);(B||G)&&(f={...f,...De(R.data,e.options)}),t._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:S,errorUpdatedAt:k,status:C}=f;h=f.data;let z=!1;if(t.placeholderData!==void 0&&h===void 0&&C==="pending"){let y;c!=null&&c.isPlaceholderData&&t.placeholderData===(b==null?void 0:b.placeholderData)?(y=c.data,z=!0):y=typeof t.placeholderData=="function"?t.placeholderData((pe=i(this,L))==null?void 0:pe.state.data,i(this,L)):t.placeholderData,y!==void 0&&(C="success",h=ve(c==null?void 0:c.data,y,t),I=!0)}if(t.select&&h!==void 0&&!z)if(c&&h===(l==null?void 0:l.data)&&t.select===i(this,W))h=i(this,j);else try{u(this,W,t.select),h=t.select(h),h=ve(c==null?void 0:c.data,h,t),u(this,j,h),u(this,x,null)}catch(y){u(this,x,y)}i(this,x)&&(S=i(this,x),h=i(this,j),k=Date.now(),C="error");const Y=f.fetchStatus==="fetching",Z=C==="pending",$=C==="error",fe=Z&&Y,de=h!==void 0,T={status:C,fetchStatus:f.fetchStatus,isPending:Z,isSuccess:C==="success",isError:$,isInitialLoading:fe,isLoading:fe,data:h,dataUpdatedAt:f.dataUpdatedAt,error:S,errorUpdatedAt:k,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>d.dataUpdateCount||f.errorUpdateCount>d.errorUpdateCount,isFetching:Y,isRefetching:Y&&!Z,isLoadingError:$&&!de,isPaused:f.fetchStatus==="paused",isPlaceholderData:I,isRefetchError:$&&de,isStale:ue(e,t),refetch:this.refetch,promise:i(this,M),isEnabled:O(t.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const y=T.data!==void 0,B=T.status==="error"&&!y,G=J=>{B?J.reject(T.error):y&&J.resolve(T.data)},be=()=>{const J=u(this,M,T.promise=me());G(J)},K=i(this,M);switch(K.status){case"pending":e.queryHash===r.queryHash&&G(K);break;case"fulfilled":(B||T.data!==K.value)&&be();break;case"rejected":(!B||T.error!==K.reason)&&be();break}}return T}updateResult(){const e=i(this,m),t=this.createResult(i(this,n),this.options);if(u(this,U,i(this,n).state),u(this,P,this.options),i(this,U).data!==void 0&&u(this,L,i(this,n)),ee(t,e))return;u(this,m,t);const r=()=>{if(!e)return!0;const{notifyOnChangeProps:a}=this.options,c=typeof a=="function"?a():a;if(c==="all"||!c&&!i(this,N).size)return!0;const l=new Set(c??i(this,N));return this.options.throwOnError&&l.add("error"),Object.keys(i(this,m)).some(b=>{const E=b;return i(this,m)[E]!==e[E]&&l.has(E)})};p(this,o,Te).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&p(this,o,ae).call(this)}},v=new WeakMap,n=new WeakMap,V=new WeakMap,m=new WeakMap,U=new WeakMap,P=new WeakMap,M=new WeakMap,x=new WeakMap,W=new WeakMap,j=new WeakMap,L=new WeakMap,D=new WeakMap,F=new WeakMap,Q=new WeakMap,N=new WeakMap,o=new WeakSet,A=function(e){p(this,o,le).call(this);let t=i(this,n).fetch(this.options,e);return e!=null&&e.throwOnError||(t=t.catch(te)),t},ie=function(){p(this,o,oe).call(this);const e=H(this.options.staleTime,i(this,n));if(se||i(this,m).isStale||!Re(e))return;const r=Qe(i(this,m).dataUpdatedAt,e)+1;u(this,D,X.setTimeout(()=>{i(this,m).isStale||this.updateResult()},r))},re=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(i(this,n)):this.options.refetchInterval)??!1},ne=function(e){p(this,o,ce).call(this),u(this,Q,e),!(se||O(this.options.enabled,i(this,n))===!1||!Re(i(this,Q))||i(this,Q)===0)&&u(this,F,X.setInterval(()=>{(this.options.refetchIntervalInBackground||Ue.isFocused())&&p(this,o,A).call(this)},i(this,Q)))},ae=function(){p(this,o,ie).call(this),p(this,o,ne).call(this,p(this,o,re).call(this))},oe=function(){i(this,D)&&(X.clearTimeout(i(this,D)),u(this,D,void 0))},ce=function(){i(this,F)&&(X.clearInterval(i(this,F)),u(this,F,void 0))},le=function(){const e=i(this,v).getQueryCache().build(i(this,v),this.options);if(e===i(this,n))return;const t=i(this,n);u(this,n,e),u(this,V,e.state),this.hasListeners()&&(t==null||t.removeObserver(this),e.addObserver(this))},Te=function(e){Me.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(i(this,m))}),i(this,v).getQueryCache().notify({query:i(this,n),type:"observerResultsUpdated"})})},Ie);function Be(s,e){return O(e.enabled,s)!==!1&&s.state.data===void 0&&!(s.state.status==="error"&&e.retryOnMount===!1)}function Ce(s,e){return Be(s,e)||s.state.data!==void 0&&he(s,e,e.refetchOnMount)}function he(s,e,t){if(O(e.enabled,s)!==!1&&H(e.staleTime,s)!=="static"){const r=typeof t=="function"?t(s):t;return r==="always"||r!==!1&&ue(s,e)}return!1}function ye(s,e,t,r){return(s!==e||O(r.enabled,s)===!1)&&(!t.suspense||s.state.status!=="error")&&ue(s,t)}function ue(s,e){return O(e.enabled,s)!==!1&&s.isStaleByTime(H(e.staleTime,s))}function Ae(s,e){return!ee(s.getCurrentResult(),e)}var _e=w.createContext(!1),He=()=>w.useContext(_e);_e.Provider;function Ve(){let s=!1;return{clearReset:()=>{s=!1},reset:()=>{s=!0},isReset:()=>s}}var We=w.createContext(Ve()),ze=()=>w.useContext(We),Ge=(s,e,t)=>{const r=t!=null&&t.state.error&&typeof s.throwOnError=="function"?we(s.throwOnError,[t.state.error,t]):s.throwOnError;(s.suspense||s.experimental_prefetchInRender||r)&&(e.isReset()||(s.retryOnMount=!1))},Ke=s=>{w.useEffect(()=>{s.clearReset()},[s])},Je=({result:s,errorResetBoundary:e,throwOnError:t,query:r,suspense:a})=>s.isError&&!e.isReset()&&!s.isFetching&&r&&(a&&s.data===void 0||we(t,[s.error,r])),Xe=s=>{if(s.suspense){const t=a=>a==="static"?a:Math.max(a??1e3,1e3),r=s.staleTime;s.staleTime=typeof r=="function"?(...a)=>t(r(...a)):t(r),typeof s.gcTime=="number"&&(s.gcTime=Math.max(s.gcTime,1e3))}},Ye=(s,e)=>s.isLoading&&s.isFetching&&!e,Ze=(s,e)=>(s==null?void 0:s.suspense)&&e.isPending,Ee=(s,e,t)=>e.fetchOptimistic(s).catch(()=>{t.clearReset()});function $e(s,e,t){var I,h,S,k;const r=He(),a=ze(),c=Fe(),l=c.defaultQueryOptions(s);(h=(I=c.getDefaultOptions().queries)==null?void 0:I._experimental_beforeQuery)==null||h.call(I,l);const b=c.getQueryCache().get(l.queryHash);l._optimisticResults=r?"isRestoring":"optimistic",Xe(l),Ge(l,a,b),Ke(a);const E=!c.getQueryCache().get(l.queryHash),[d]=w.useState(()=>new e(c,l)),R=d.getOptimisticResult(l),f=!r&&s.subscribed!==!1;if(w.useSyncExternalStore(w.useCallback(C=>{const z=f?d.subscribe(Me.batchCalls(C)):te;return d.updateResult(),z},[d,f]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),w.useEffect(()=>{d.setOptions(l)},[l,d]),Ze(l,R))throw Ee(l,d,a);if(Je({result:R,errorResetBoundary:a,throwOnError:l.throwOnError,query:b,suspense:l.suspense}))throw R.error;if((k=(S=c.getDefaultOptions().queries)==null?void 0:S._experimental_afterQuery)==null||k.call(S,l,R),l.experimental_prefetchInRender&&!se&&Ye(R,r)){const C=E?Ee(l,d,a):b==null?void 0:b.promise;C==null||C.catch(te).finally(()=>{d.updateResult()})}return l.notifyOnChangeProps?R:d.trackResult(R)}function rt(s,e){return $e(s,ke)}function Se(...s){const e={};return s.forEach(t=>{t&&Object.keys(t).forEach(r=>{t[r]!==void 0&&(e[r]=t[r])})}),e}function nt(s){if(!s)return;const{closable:e,closeIcon:t}=s;return{closable:e,closeIcon:t}}function Oe(s){const{closable:e,closeIcon:t}=s||{};return _.useMemo(()=>{if(!e&&(e===!1||t===!1||t===null))return!1;if(e===void 0&&t===void 0)return null;let r={closeIcon:typeof t!="boolean"&&t!==null?t:void 0};return e&&typeof e=="object"&&(r=Object.assign(Object.assign({},r),e)),r},[e,t])}const qe={},at=(s,e,t=qe)=>{const r=Oe(s),a=Oe(e),[c]=Pe("global",Le.global),l=typeof r!="boolean"?!!(r!=null&&r.disabled):!1,b=_.useMemo(()=>Object.assign({closeIcon:_.createElement(Ne,null)},t),[t]),E=_.useMemo(()=>r===!1?!1:r?Se(b,a,r):a===!1?!1:a?Se(b,a):b.closable?b:!1,[r,a,b]);return _.useMemo(()=>{var d,R;if(E===!1)return[!1,null,l,{}];const{closeIconRender:f}=b,{closeIcon:I}=E;let h=I;const S=je(E,!0);return h!=null&&(f&&(h=f(I)),h=_.isValidElement(h)?_.cloneElement(h,Object.assign(Object.assign(Object.assign({},h.props),{"aria-label":(R=(d=h.props)===null||d===void 0?void 0:d["aria-label"])!==null&&R!==void 0?R:c.close}),S)):_.createElement("span",Object.assign({"aria-label":c.close},S),h)),[!0,h,l,S]},[l,c.close,E,b])};export{at as a,Se as m,nt as p,rt as u};
